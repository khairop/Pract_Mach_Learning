<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1253">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
h1
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri","sans-serif";
	color:#345A8A;}
h2
	{margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h3
	{margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h4
	{margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h5
	{margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;
	font-weight:normal;
	font-style:italic;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri","sans-serif";
	color:#345A8A;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.MsoDate, li.MsoDate, div.MsoDate
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.Compact, li.Compact, div.Compact
	{mso-style-name:Compact;
	margin-top:1.8pt;
	margin-right:0cm;
	margin-bottom:1.8pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.Authors, li.Authors, div.Authors
	{mso-style-name:Authors;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:center;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.BlockQuote, li.BlockQuote, div.BlockQuote
	{mso-style-name:"Block Quote";
	margin-top:5.0pt;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.Definition, li.Definition, div.Definition
	{mso-style-name:Definition;
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
p.ImageCaption, li.ImageCaption, div.ImageCaption
	{mso-style-name:"Image Caption";
	mso-style-link:"Body Text Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Image Caption";}
span.VerbatimChar
	{mso-style-name:"Verbatim Char";
	mso-style-link:"Source Code";
	font-family:Consolas;}
span.FootnoteRef
	{mso-style-name:"Footnote Ref";
	vertical-align:super;}
span.Link
	{mso-style-name:Link;
	color:#4F81BD;}
p.SourceCode, li.SourceCode, div.SourceCode
	{mso-style-name:"Source Code";
	mso-style-link:"Verbatim Char";
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	background:#F8F8F8;
	word-break:break-all;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
span.KeywordTok
	{mso-style-name:KeywordTok;
	font-family:Consolas;
	color:#204A87;
	background:#F8F8F8;
	font-weight:bold;}
span.DataTypeTok
	{mso-style-name:DataTypeTok;
	font-family:Consolas;
	color:#204A87;
	background:#F8F8F8;}
span.DecValTok
	{mso-style-name:DecValTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.BaseNTok
	{mso-style-name:BaseNTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.FloatTok
	{mso-style-name:FloatTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.CharTok
	{mso-style-name:CharTok;
	font-family:Consolas;
	color:#4E9A06;
	background:#F8F8F8;}
span.StringTok
	{mso-style-name:StringTok;
	font-family:Consolas;
	color:#4E9A06;
	background:#F8F8F8;}
span.CommentTok
	{mso-style-name:CommentTok;
	font-family:Consolas;
	color:#8F5902;
	background:#F8F8F8;
	font-style:italic;}
span.OtherTok
	{mso-style-name:OtherTok;
	font-family:Consolas;
	color:#8F5902;
	background:#F8F8F8;}
span.AlertTok
	{mso-style-name:AlertTok;
	font-family:Consolas;
	color:#EF2929;
	background:#F8F8F8;}
span.FunctionTok
	{mso-style-name:FunctionTok;
	font-family:Consolas;
	color:black;
	background:#F8F8F8;}
span.RegionMarkerTok
	{mso-style-name:RegionMarkerTok;
	font-family:Consolas;
	background:#F8F8F8;}
span.ErrorTok
	{mso-style-name:ErrorTok;
	font-family:Consolas;
	background:#F8F8F8;
	font-weight:bold;}
span.NormalTok
	{mso-style-name:NormalTok;
	font-family:Consolas;
	background:#F8F8F8;}
.MsoChpDefault
	{font-size:12.0pt;
	font-family:"Cambria","serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EL>

<div class=WordSection1>

<h1><a name=practical-machine-learning-peer-assessme><span lang=EN-US>Practical
Machine Learning Peer Assessment</span></a></h1>

<h2><a name=summary><span lang=EN-US>Summary</span></a></h2>

<p class=MsoNormal><span lang=EN-US>This analysis has been done to predict the
manner in which persons performed weight lifting exercises. The data is
collected from accelerometers on the belt, forearm, arm, and dumbell of 6
participants. The outcome variable has five classes and the total number of
predictors are 159</span></p>

<h2><a name=loading-various-libraries-and-preparing-><span lang=EN-US>Loading
various libraries, and preparing the data (using subdirectory data)</span></a></h2>

<p class=SourceCode><span class=KeywordTok><span lang=EN-US style='font-size:
11.0pt'>library</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>(caret)</span></span></p>

<p class=SourceCode><span class=VerbatimChar><span lang=EN-US style='font-size:
11.0pt'>## Loading required package: lattice</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Loading required package: ggplot2</span></span></p>

<p class=SourceCode><span class=KeywordTok><span lang=EN-US style='font-size:
11.0pt'>library</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>(randomForest)</span></span></p>

<p class=SourceCode><span class=VerbatimChar><span lang=EN-US style='font-size:
11.0pt'>## randomForest 4.6-10</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Type rfNews() to see new features/changes/bug fixes.</span></span></p>

<p class=SourceCode><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>training &lt;-</span></span><span class=StringTok><span lang=EN-US
style='font-size:11.0pt'> </span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>read.csv</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;./data/pml-training.csv&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>row.names=</span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>1</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>na.strings =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing
&lt;-</span></span><span class=StringTok><span lang=EN-US style='font-size:
11.0pt'> </span></span><span class=KeywordTok><span lang=EN-US
style='font-size:11.0pt'>read.csv</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(</span></span><span class=StringTok><span
lang=EN-US style='font-size:11.0pt'>&quot;./data/pml-testing.csv&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>row.names=</span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>1</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>na.strings =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;NA&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span></p>

<h2><a name=preprocessing-data><span lang=EN-US>Preprocessing data</span></a></h2>

<p class=MsoNormal><span lang=EN-US>We need to exclude the variables that have
almost to zero variance in both training and testing data. Then exclude the
columns with missing values to avoid problems in training models.</span></p>

<p class=SourceCode><span class=CommentTok><span lang=EN-US style='font-size:
11.0pt'># remove near zero covariates using caret package, 75 variables
remaining in both sets (from 159)</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>nsv =</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>nearZeroVar</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>saveMetrics=</span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>TRUE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training[,!nsv$nzv]</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing[,!nsv$nzv]</span></span><span
lang=EN-US><br>
<br>
</span><span class=CommentTok><span lang=EN-US style='font-size:11.0pt'>#
Remove variables with missing values, 58 variables reamining in training set</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_na
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training[,(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>colSums</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>is.na</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training)) ==</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>0</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)]</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing_na
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing[,(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>colSums</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>is.na</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(testing)) ==</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>0</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)]</span></span><span
lang=EN-US><br>
<br>
</span><span class=CommentTok><span lang=EN-US style='font-size:11.0pt'>#
Remove unnecessary columns, (53 cariables remaining for training, 52 variables
for testing)</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>string_train
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>c</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;user_name&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;raw_timestamp_part_1&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;raw_timestamp_part_2&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;cvtd_timestamp&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;num_window&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>string_test
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>c</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;user_name&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;raw_timestamp_part_1&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;raw_timestamp_part_2&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;cvtd_timestamp&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;num_window&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;problem_id&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_col
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_na[,!(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>names</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training_na) %in%</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>string_train)]</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing_col
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing_na[,!(</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>names</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(testing_na) %in%</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>string_test)]</span></span><span
lang=EN-US><br>
</span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>dim</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training_col)</span></span></p>

<p class=SourceCode><span class=VerbatimChar><span lang=EN-US style='font-size:
11.0pt'>## [1] 19622    53</span></span></p>

<p class=SourceCode><span class=KeywordTok><span lang=EN-US style='font-size:
11.0pt'>dim</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>(testing_col)</span></span></p>

<p class=SourceCode><span class=VerbatimChar><span lang=EN-US style='font-size:
11.0pt'>## [1] 20 52</span></span></p>

<p class=MsoNormal><span lang=EN-US>Now we split the preprocessed training data
into training set and validation set.</span></p>

<p class=SourceCode><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>intrain =</span></span><span class=StringTok><span lang=EN-US
style='font-size:11.0pt'> </span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>createDataPartition</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>y=</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training$classe, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>p=</span></span><span
class=FloatTok><span lang=EN-US style='font-size:11.0pt'>0.7</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>list=</span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>FALSE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_clean
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_col[intrain,]</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>validation_clean
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>training_col[-intrain,]</span></span></p>

<p class=MsoNormal><span lang=EN-US>In the new training set and validation set
we just created, there are 52 predictors and 1 response. We heck the
correlations between the predictors and the outcome variable in the new
training set. There doesn’t seem to be any predictors strongly correlated (all
of them are close to 0) with the outcome variable, so linear regression model
is not recommnded. Random forest model may be more suitable for this data.</span></p>

<p class=SourceCode><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>cor =</span></span><span class=StringTok><span lang=EN-US
style='font-size:11.0pt'> </span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>abs</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(</span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>sapply</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(</span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>colnames</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training_clean[, -</span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>ncol</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training)]),
function(x) </span></span><span class=KeywordTok><span lang=EN-US
style='font-size:11.0pt'>cor</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(</span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>as.numeric</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(training_clean[,
x]), </span></span><span class=KeywordTok><span lang=EN-US style='font-size:
11.0pt'>as.numeric</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>(training_clean$classe), </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>method =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;spearman&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)))</span></span></p>

<h2><a name=random-forest-model><span lang=EN-US>Random Forest Model</span></a></h2>

<p class=MsoNormal><span lang=EN-US>We try to fit a random forest model and
check the model performance on the validation set.</span></p>

<p class=SourceCode><span class=KeywordTok><span lang=EN-US style='font-size:
11.0pt'>set.seed</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>(</span></span><span class=DecValTok><span lang=EN-US
style='font-size:11.0pt'>4321</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>)</span></span><span lang=EN-US><br>
</span><span class=CommentTok><span lang=EN-US style='font-size:11.0pt'># Fit
rf model</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>rffit =</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>train</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(classe ~</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>., </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>method =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;rf&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>data =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> training_clean, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>importance =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> T, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>trControl =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>trainControl</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>method =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;cv&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>number =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>4</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>))</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>validation_pred
=</span></span><span class=StringTok><span lang=EN-US style='font-size:11.0pt'>
</span></span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>predict</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(rffit, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>newdata=</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>validation_clean)</span></span><span
lang=EN-US><br>
</span><span class=CommentTok><span lang=EN-US style='font-size:11.0pt'># Check
model performance</span></span><span lang=EN-US><br>
</span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>confusionMatrix</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(validation_pred,validation_clean$classe)</span></span></p>

<p class=SourceCode><span class=VerbatimChar><span lang=EN-US style='font-size:
11.0pt'>## Confusion Matrix and Statistics</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## </span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##          
Reference</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Prediction    A    B    C    D    E</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##         
A 1670    5    0    0    0</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##         
B    2 1131    8    0    0</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##         
C    1    2 1013   12    0</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##         
D    0    1    5  951    3</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##         
E    1    0    0    1 1079</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## </span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Overall Statistics</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##                                         
</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##               
Accuracy : 0.993          </span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##                 
95% CI : (0.9906, 0.995)</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##    
No Information Rate : 0.2845         </span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##    
P-Value [Acc &gt; NIR] : &lt; 2.2e-16      </span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##                                         
</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##                  
Kappa : 0.9912         </span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## 
Mcnemar's Test P-Value : NA             </span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## </span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Statistics by Class:</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## </span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##                     
Class: A Class: B Class: C Class: D Class: E</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>## Sensitivity           
0.9976   0.9930   0.9873   0.9865   0.9972</span></span><span lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Specificity            0.9988   0.9979   0.9969   0.9982   0.9996</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Pos Pred Value         0.9970   0.9912   0.9854   0.9906   0.9981</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Neg Pred Value         0.9990   0.9983   0.9973   0.9974   0.9994</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Detection Rate         0.2838   0.1922   0.1721   0.1616   0.1833</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Detection Prevalence   0.2846   0.1939   0.1747   0.1631   0.1837</span></span><span
lang=EN-US><br>
</span><span class=VerbatimChar><span lang=EN-US style='font-size:11.0pt'>##
Balanced Accuracy      0.9982   0.9954   0.9921   0.9923   0.9984</span></span></p>

<p class=SourceCode><span class=CommentTok><span lang=EN-US style='font-size:
11.0pt'>#check important variables</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>imp =</span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>varImp</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(rffit)$importance</span></span><span
lang=EN-US><br>
</span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>varImpPlot</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(rffit$finalModel, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>sort =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>TRUE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>type =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>1</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>pch =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>19</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>col =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>1</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>cex =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=DecValTok><span lang=EN-US style='font-size:11.0pt'>1</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>main =</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'> </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;Importance of
the Predictors&quot;</span></span><span class=NormalTok><span lang=EN-US
style='font-size:11.0pt'>)</span></span></p>

<p class=MsoNormal><img width=484 height=388 id=Picture
src="PML_filtered_files/image001.png"></p>

<p class=MsoNormal><span lang=EN-US>The random forest algorithm generates a model
with accuracy 0.9935. The top 4 most important variables are roll_bell,
yaw_belt, pitch_forearm and pitch_belt.</span></p>

<h2><a name=prediction><span lang=EN-US>Prediction</span></a></h2>

<p class=MsoNormal><span lang=EN-US>The last step is to use the random forest
model to predict on the testing set without the outcome variable and save the
prediction output.</span></p>

<p class=SourceCode><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>testing_pred &lt;-</span></span><span class=StringTok><span lang=EN-US
style='font-size:11.0pt'> </span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>predict</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(rffit, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>newdata=</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>testing_col)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>write_files
&lt;-</span></span><span class=StringTok><span lang=EN-US style='font-size:
11.0pt'> </span></span><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>function(x) {</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>       
n &lt;-</span></span><span class=StringTok><span lang=EN-US style='font-size:
11.0pt'> </span></span><span class=KeywordTok><span lang=EN-US
style='font-size:11.0pt'>length</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(x)</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>        for
(i in </span></span><span class=DecValTok><span lang=EN-US style='font-size:
11.0pt'>1</span></span><span class=NormalTok><span lang=EN-US style='font-size:
11.0pt'>:n) {</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>               
filename &lt;-</span></span><span class=StringTok><span lang=EN-US
style='font-size:11.0pt'> </span></span><span class=KeywordTok><span
lang=EN-US style='font-size:11.0pt'>paste0</span></span><span class=NormalTok><span
lang=EN-US style='font-size:11.0pt'>(</span></span><span class=StringTok><span
lang=EN-US style='font-size:11.0pt'>&quot;problem_id&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, i, </span></span><span
class=StringTok><span lang=EN-US style='font-size:11.0pt'>&quot;.txt&quot;</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>               
</span></span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>write.table</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(x[i], </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>file=</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>filename, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>quote=</span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>FALSE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>, </span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>row.names=</span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>FALSE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok><span lang=EN-US style='font-size:11.0pt'>col.names=</span></span><span
class=OtherTok><span lang=EN-US style='font-size:11.0pt'>FALSE</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>)</span></span><span
lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>       
}</span></span><span lang=EN-US><br>
</span><span class=NormalTok><span lang=EN-US style='font-size:11.0pt'>}</span></span><span
lang=EN-US><br>
</span><span class=KeywordTok><span lang=EN-US style='font-size:11.0pt'>write_files</span></span><span
class=NormalTok><span lang=EN-US style='font-size:11.0pt'>(testing_pred)</span></span></p>

<h2><a name=results><span lang=EN-US>Results</span></a></h2>

<p class=MsoNormal><span lang=EN-US>We used 52 variables to build the random
forest model with 4-fold cross validation.</span></p>

</div>

</body>

</html>
